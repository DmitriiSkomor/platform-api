# Игровая Платформа API

## Описание

Это приложение представляет собой систему для игровой платформы, которая взаимодействует с игровым сайтом и
провайдером игр. Приложение обрабатывает запросы баланса (`api: "balance"`), и информирует
платформу о ставках (дебет - `api: "debit"`) и выигрышах или проигрышах (кредит - `api: "credit"`). Вся информация о
пользователях, их балансах и транзакциях сохраняется во встроенной базе данных H2 для упрощения тестирования и
развертывания.

## Запуск приложения

### Через командную строку

1. Склонируйте репозиторий приложения на ваш локальный компьютер с помощью `git clone`.
2. Откройте командную строку и перейдите в каталог проекта.
3. Выполните команду: mvn spring-boot:run

### Через IDE

1. Импортируйте проект в вашу IDE как Maven проект.
2. Дождитесь, пока зависимости проекта будут загружены.
3. Запустите главный класс приложения (`@SpringBootApplication` аннотированный класс) напрямую из IDE.

## Инструкция по использованию

### Примеры запросов

#### Получение баланса

```
curl --location 'http://localhost:8080/open-api-games/v1/games-processor' \
--header 'Content-Type: application/json' \
--header 'sign: c3fd2f1e11ef496c982ac4432318a903' \
--data '{
    "api": "balance",
    "data": {
        "gameSessionId": "16e2ea64-5725-40a4-99cc-c5c0deb8568d"
    }
}'
```

#### Дебет (ставка)

```
curl --location 'http://localhost:8080/open-api-games/v1/games-processor' \
--header 'Content-Type: application/json' \
--header 'sign: d3664e1da13e64b6e9b9362c28f58567' \
--data '{
    "api": "debit",
    "data": {
        "gameSessionId": "16e2ea64-5725-40a4-99cc-c5c0deb8568d",
        "amount": 1000,
        "betId": "round-123"
    }
}'
```

#### Кредит (выигрыш/проигрыш)

##### (Если amount больше нуля, то речь идет выигрыше, иначе речь идет о проигрыше.)

```
curl --location 'http://localhost:8080/open-api-games/v1/games-processor' \
--header 'Content-Type: application/json' \
--header 'sign: 99c9eaf72f8fb36164127de3075d4f61' \
--data '{
    "api": "credit",
    "data": {
        "gameSessionId": "16e2ea64-5725-40a4-99cc-c5c0deb8568d",
        "amount": 0,
        "betId": "round-123"
    }
}'
```

### Генерация подписи

#### Для создания подписи используйте следующий скрипт:

```
echo -n '{"api":"balance","data":{"gameSessionId":"ваш_идентификатор_сессии"}}ваш_секретный_ключ' | md5sum
```

#### Замените ваш_идентификатор_сессии и ваш_секретный_ключ на соответствующие значения.

### Добавление тестовых данных

#### Для добавления тестовых данных используйте файл data.sql, который будет автоматически применен при запуске приложения.
